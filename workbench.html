<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ResBuilder</title>
    <link rel="shortcut icon" type="image/png" href="./images/logos/favicon.png" />
    <link rel="stylesheet" href="./css/styles.min.css" />
    <link rel="stylesheet" href="./libs/dragula-master/dist/dragula.css" />
    <link rel="stylesheet" href="./libs/dragula-master/dist/dragula.min.css" />
    <!--<link rel="stylesheet" href="./libs/tabmaster/tabstyle.css" />-->
    <link rel="stylesheet" href="/path/to/leaflet.css" />
    <style>

        h1 {
            margin-top: 20px;
            margin-bottom: 20px;
            font-size: 2.5rem;
            color: #343a40;
        }

        .container {
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin: 10px;
        }

        .scrollable-zone {
            max-height: 300px; /* Adjust the height as needed */
            overflow-y: auto;
            padding-right: 10px; /* Prevents content from hiding behind the scrollbar */
        }
        
        .item {
            padding: 12px;
            margin: 6px 0;
            background-color: #DBE6F2;
            color: #000000;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
            font-size: 1rem;
        }

        .item:hover {
            background-color: #9ab4d0;
        }

        .tab-content {
            display: flex;
            flex-direction: column;
            min-height: 250px;
            overflow: hidden;
        }

        .tab-pane {
            flex-grow: 1;
            background: #f1f3f5;
            border-radius: 8px;
            padding: 15px;
            transition: opacity 0.05s ease-in-out;
        }

        .tab-pane.show {
            opacity: 1;
        }

        .nav-tabs .nav-link {
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px 15px;
            margin: 0 2px;
        }

        .nav-tabs .nav-link.active {
            background-color: #007bff;
            color: #ffffff;
            border-color: #007bff;
        }

        .modal-content {
            border-radius: 8px;
        }

        .modal-header, .modal-body, .modal-footer {
            border: none;
        }

        .modal-footer button {
            border-radius: 4px;
        }
    </style>
</head>

<body onload="init()">
    <!--  Body Wrapper -->
    <div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
         data-sidebar-position="fixed" data-header-position="fixed">
        <!-- Sidebar Start -->
        <aside class="left-sidebar">
            <!-- Sidebar scroll-->
            <div>
                <div class="brand-logo d-flex align-items-center justify-content-between">
                    <a href="./index.html" class="text-nowrap logo-img">
                        <img src="./images/logos/resbuilder_icon.png" width="180" alt="" />
                    </a>
                    <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
                        <i class="ti ti-x fs-8"></i>
                    </div>
                </div>
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
                    <ul id="sidebarnav">
                        <li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">Home</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./index.html" aria-expanded="true">
                                <span>
                                    <i class="ti ti-chart-infographic"></i>
                                </span>
                                <span class="hide-menu">Dashboard</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./workbench.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-article"></i>
                                </span>
                                <span class="hide-menu">Workbench</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./authentication-login.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-message-circle"></i>
                                </span>
                                <span class="hide-menu">Chat</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./authentication-login.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-file-description"></i>
                                </span>
                                <span class="hide-menu">Support</span>
                            </a>
                        </li>
                        <!--<li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">UI COMPONENTS</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./ui-buttons.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-article"></i>
                                </span>
                                <span class="hide-menu">Buttons</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./ui-alerts.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-alert-circle"></i>
                                </span>
                                <span class="hide-menu">Alerts</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./ui-card.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-cards"></i>
                                </span>
                                <span class="hide-menu">Card</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./ui-forms.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-file-description"></i>
                                </span>
                                <span class="hide-menu">Forms</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./ui-typography.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-typography"></i>
                                </span>
                                <span class="hide-menu">Typography</span>
                            </a>
                        </li>-->
                        <li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">AUTH</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./authentication-login.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-login"></i>
                                </span>
                                <span class="hide-menu">Log out</span>
                            </a>
                        </li>
                        <!--<li class="sidebar-item">
                            <a class="sidebar-link" href="./authentication-register.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-user-plus"></i>
                                </span>
                                <span class="hide-menu">Register</span>
                            </a>
                        </li>
                        <li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">EXTRA</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./icon-tabler.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-mood-happy"></i>
                                </span>
                                <span class="hide-menu">Icons</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./sample-page.html" aria-expanded="false">
                                <span>
                                    <i class="ti ti-aperture"></i>
                                </span>
                                <span class="hide-menu">Sample Page</span>
                            </a>
                        </li>-->
                    </ul>
                    <!--<div class="unlimited-access hide-menu bg-light-primary position-relative mb-7 mt-5 rounded">
                      <div class="d-flex">
                        <div class="unlimited-access-title me-3">
                          <h6 class="fw-semibold fs-4 mb-6 text-dark w-85">Upgrade to pro</h6>
                          <a href="https://adminmart.com/product/modernize-bootstrap-5-admin-template/" target="_blank" class="btn btn-primary fs-2 fw-semibold lh-sm">Buy Pro</a>
                        </div>
                        <div class="unlimited-access-img">
                          <img src="./images/backgrounds/rocket.png" alt="" class="img-fluid">
                        </div>
                      </div>
                    </div>-->
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->
        </aside>
        <!--  Sidebar End -->
        <!--  Main wrapper -->
        <div class="body-wrapper">
            <!--  Header Start -->
            <header class="app-header">
                <nav class="navbar navbar-expand-lg navbar-light">
                    <ul class="navbar-nav">
                        <li class="nav-item d-block d-xl-none">
                            <a class="nav-link sidebartoggler nav-icon-hover" id="headerCollapse" href="javascript:void(0)">
                                <i class="ti ti-menu-2"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-icon-hover" href="javascript:void(0)">
                                <i class="ti ti-bell-ringing"></i>
                                <div class="notification bg-primary rounded-circle"></div>
                            </a>
                        </li>
                    </ul>
                    <div class="navbar-collapse justify-content-end px-0" id="navbarNav">
                        <ul class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
                            <li class="nav-item dropdown">
                                <a class="nav-link nav-icon-hover" href="javascript:void(0)" id="drop2" data-bs-toggle="dropdown"
                                   aria-expanded="false">
                                    <img src="./images/profile/user-1.jpg" alt="" width="35" height="35" class="rounded-circle">
                                </a>
                                <div class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up" aria-labelledby="drop2">
                                    <div class="message-body">
                                        <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                                            <i class="ti ti-user fs-6"></i>
                                            <p class="mb-0 fs-3">My Profile</p>
                                        </a>
                                        <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                                            <i class="ti ti-mail fs-6"></i>
                                            <p class="mb-0 fs-3">My Account</p>
                                        </a>
                                        <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                                            <i class="ti ti-list-check fs-6"></i>
                                            <p class="mb-0 fs-3">My Task</p>
                                        </a>
                                        <a href="./authentication-login.html" class="btn btn-outline-primary mx-3 mt-2 d-block">Logout</a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </header>
            <!--  Header End -->
            <div class="container-fluid">
                <!--  Row 1 -->
                <div class="row">
                    <div class="col-lg-11 d-flex align-items-strech">
                        <div class="card w-100">
                            <div class="card-body">
                                <div class="d-sm-flex d-block align-items-center justify-content-between mb-9">
                                    <div class="mb-3 mb-sm-0">
                                        <h6 class="card-title fw-semibold">Service Mapping</h6>
                                        <span class="fw-normal">Select and edit Entity and Service</span>
                                    </div>
                                    <div>
                                        <select class="form-select">
                                            <option value="1">Select Entity</option>
                                            <option value="2">Bank of ResBuilder Ltd</option>
                                        </select>
                                    </div>
                                    <div>
                                        <select class="form-select">
                                            <option value="1">Select service</option>
                                            <option value="2">Car Loan Service</option>
                                            <option value="3">Mortgage Loan Service</option>
                                            <option value="4">Commercial Loan Service</option>
                                            <option value="5">Corporate Loan Service</option>
                                            <option value="6">Business Loan Service</option>
                                            <option value="7">Domestic Payment Service Inbound</option>
                                            <option value="8">Domestic Payment Service Outbound</option>
                                            <option value="9">Debit Card Service</option>
                                            <option value="10">Credit Card Service</option>
                                            <option value="11">International Payment Service Inbound</option>
                                            <option value="12">International Payment Service Outbound</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-2 d-flex align-items-stretch">
                        <div class="container card" id="left-container">
                            <!-- Search box for filtering items -->
                            <div class="mb-3">
                                <input type="text" id="searchBox" class="form-control" placeholder="Search...">
                            </div>
                            <!-- Scrollable container for items -->
                            <div class="scrollable-zone" id="scrollable-zone">
                                <button class="item btn btn-light">Item 1</button>
                                <button class="item btn btn-light">Item 2</button>
                                <button class="item btn btn-light">Item 3</button>
                                <button class="item btn btn-light">Item 4</button>
                                <button class="item btn btn-light">Item 5</button>
                                <button class="item btn btn-light">Item 6</button>
                                <button class="item btn btn-light">Item 7</button>
                                <button class="item btn btn-light">Item 8</button>
                                <button class="item btn btn-light">Item 9</button>
                                <button class="item btn btn-light">Item 10</button>
                            </div>
                        </div>
                    </div>
                    <!-- Bootstrap Tabs for Zone 2 -->
                        <div class="container card col-lg-8 align-items-stretch">
                            <ul class="nav nav-tabs" id="myTab" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="people-tab" data-bs-toggle="tab" href="#people" role="tab" aria-controls="people" aria-selected="true">People</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="location-tab" data-bs-toggle="tab" href="#location" role="tab" aria-controls="location" aria-selected="false">Location</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="applications-tab" data-bs-toggle="tab" href="#applications" role="tab" aria-controls="applications" aria-selected="false">Applications</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="hardware-tab" data-bs-toggle="tab" href="#hardware" role="tab" aria-controls="hardware" aria-selected="false">Hardware</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="suppliers-tab" data-bs-toggle="tab" href="#suppliers" role="tab" aria-controls="suppliers" aria-selected="false">Suppliers</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="data-tab" data-bs-toggle="tab" href="#data" role="tab" aria-controls="data" aria-selected="false">Data</button>
                                </li>
                            </ul>
                            <div class="tab-content" id="myTabContent">
                                <div class="tab-pane fade show active" id="people" role="tabpanel" aria-labelledby="people-tab"></div>
                                <div class="tab-pane fade" id="location" role="tabpanel" aria-labelledby="location-tab"></div>
                                <div class="tab-pane fade" id="applications" role="tabpanel" aria-labelledby="applications-tab"></div>
                                <div class="tab-pane fade" id="hardware" role="tabpanel" aria-labelledby="hardware-tab"></div>
                                <div class="tab-pane fade" id="suppliers" role="tabpanel" aria-labelledby="suppliers-tab"></div>
                                <div class="tab-pane fade" id="data" role="tabpanel" aria-labelledby="data-tab"></div>
                            </div>
                        </div>

                        <!-- Confirm Modal -->
                        <div class="modal fade" id="dropModal" tabindex="-1" aria-labelledby="dropModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="dropModalLabel">Confirm Action</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="modalForm">
                                            <div class="mb-3">
                                                <label for="wfhInput" class="form-label">How many WFH:</label>
                                                <input type="number" class="form-control" id="wfhInput" min="0">
                                            </div>
                                            <div class="mb-3">
                                                <label for="officeInput" class="form-label">How many work at office:</label>
                                                <input type="number" class="form-control" id="officeInput" min="0">
                                            </div>
                                            <div class="mb-3">
                                                <label for="exclusiveInput" class="form-label">What % of people in this Role work on this service exclusively:</label>
                                                <input type="number" class="form-control" id="exclusiveInput" min="0" max="100">
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" id="cancelBtn" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-primary" id="confirmBtn">Confirm</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Remove Modal -->
                        <div class="modal fade" id="removeModal" tabindex="-1" aria-labelledby="removeModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="removeModalLabel">Remove Item</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="removeModalForm">
                                            <div class="mb-3">
                                                <label for="removeWfhInput" class="form-label">How many WFH:</label>
                                                <input type="number" class="form-control" id="removeWfhInput" min="0">
                                            </div>
                                            <div class="mb-3">
                                                <label for="removeOfficeInput" class="form-label">How many work at office:</label>
                                                <input type="number" class="form-control" id="removeOfficeInput" min="0">
                                            </div>
                                            <div class="mb-3">
                                                <label for="removeExclusiveInput" class="form-label">What % of people in this Role work on this service exclusively:</label>
                                                <input type="number" class="form-control" id="removeExclusiveInput" min="0" max="100">
                                            </div>
                                        </form>
                                        <p>Do you want to remove this item?</p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" id="removeCancelBtn" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-primary" id="saveChangesBtn">Save</button>
                                        <button type="button" class="btn btn-danger" id="removeConfirmBtn">Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>               
                </div>
            </div>
        </div>
    </div>
    <script src="./libs/jquery/dist/jquery.min.js"></script>
    <script src="./libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./js/sidebarmenu.js"></script>
    <script src="./js/app.min.js"></script>
    <script src="./libs/apexcharts/dist/apexcharts.min.js"></script>
    <script src="./libs/apexcharts/dist/apexcharts.esm.js"></script>
    <script src="./libs/simplebar/dist/simplebar.js"></script>
    <script src="./js/dashboard.js"></script>
    <script src="./libs/dragula-master/dist/dragula.js"></script>
    <script src="./libs/dragula-master/dist/dragula.min.js"></script>
    <!--<script src="./libs/tabmaster/tabscript.js"></script>-->
    <script src="/path/to/leaflet.js"></script>
    <!--<script src="./js/wb_dragdrop.js"></script>-->
    <script>
    let drake;
    let originalContainer, originalIndex, originalText;
    let lastDraggedElement = null;
    let clickedItem = null;
    const itemsData = new Map(); // Map to store original titles of items

    // Sorting function for Drop Zone 1
    function sortItems() {
        const items = Array.from(document.querySelectorAll('#scrollable-zone .item'));
        items.sort((a, b) => a.textContent.trim().localeCompare(b.textContent.trim(), undefined, {numeric: true}));
        items.forEach(item => document.getElementById('scrollable-zone').appendChild(item));
    }

    $(document).ready(function () {
        // Dragula initialization
        drake = dragula([
            document.getElementById('scrollable-zone'),
            document.getElementById('people'),
            document.getElementById('location'),
            document.getElementById('applications'),
            document.getElementById('hardware'),
            document.getElementById('suppliers'),
            document.getElementById('data')
        ], {
            accepts: function (el, target, source) {
                return target !== document.getElementById('scrollable-zone');
            }
        });

        // Track original container and index
        drake.on('drag', function (el, source) {
            originalContainer = source;
            originalIndex = Array.prototype.indexOf.call(source.children, el);
            originalText = el.textContent.trim();
        });

        // Drop event with modal confirmation
        drake.on('drop', function (el, target, source) {
            if (target && target !== source) {
                lastDraggedElement = el;

                // Show confirmation modal
                $('#dropModal').modal('show');

                // Cancel button action
                $('#cancelBtn').off('click').on('click', function () {
                    if (originalContainer) {
                        originalContainer.insertBefore(el, originalContainer.children[originalIndex]);
                        el.textContent = originalText;
                        sortItems(); // Sort items after returning to the original zone
                    }
                });

                // Confirm button action
                $('#confirmBtn').off('click').on('click', function () {
                    const wfhValue = $('#wfhInput').val();
                    const officeValue = $('#officeInput').val();
                    const exclusiveValue = $('#exclusiveInput').val();

                    // Check if any of the fields are empty
                    if (wfhValue === '' || officeValue === '' || exclusiveValue === '') {
                        alert('Please enter values in all fields.');
                        return;
                    }

                    // Validate range of exclusiveInput (0-100)
                    if (exclusiveValue < 0 || exclusiveValue > 100) {
                        alert('Exclusive percentage must be between 0 and 100.');
                        return;
                    }

                    // Store original text and update the item with additional info
                    const updatedText = `${originalText} \n WFH: ${wfhValue} \n Office: ${officeValue} \n Exclusive: ${exclusiveValue}%`;
                    itemsData.set(el, originalText); // Store the original title in the map
                    el.textContent = updatedText;

                    $('#dropModal').modal('hide');
                    sortItems(); // Sort items after confirming the drop
                });
            }
        });

        // Event listener for clicks on items in tab panes
        $(document).on('click', '.tab-pane .item', function () {
            clickedItem = $(this);
            const currentText = clickedItem.text();
            const matches = currentText.match(/WFH: (\d+)\s*Office: (\d+)\s*Exclusive: (\d+)%/);

            // Pre-fill the inputs with current values if matches are found
            if (matches) {
                $('#removeWfhInput').val(matches[1]);
                $('#removeOfficeInput').val(matches[2]);
                $('#removeExclusiveInput').val(matches[3]);
            }

            $('#removeModal').modal('show');
        });

        // Save changes button action
        $('#saveChangesBtn').off('click').on('click', function () {
            const wfhValue = $('#removeWfhInput').val();
            const officeValue = $('#removeOfficeInput').val();
            const exclusiveValue = $('#removeExclusiveInput').val();

            // Check if any of the fields are empty
            if (wfhValue === '' || officeValue === '' || exclusiveValue === '') {
                alert('Please enter values in all fields.');
                return;
            }

            // Validate range of exclusiveInput (0-100)
            if (exclusiveValue < 0 || exclusiveValue > 100) {
                alert('Exclusive percentage must be between 0 and 100.');
                return;
            }

            // Update the clicked item's text with new values
            const originalTitle = clickedItem.text().split('\n')[0].trim();
            const updatedText = `${originalTitle} \n WFH: ${wfhValue} \n Office: ${officeValue} \n Exclusive: ${exclusiveValue}%`;
            clickedItem.text(updatedText);
            $('#removeModal').modal('hide');
        });

        // Remove item when confirmed
        $('#removeConfirmBtn').off('click').on('click', function () {
            $('#removeModal').on('hidden.bs.modal', function () {
                if (clickedItem) {
                    $('#scrollable-zone').append(clickedItem); // Move back to Drop Zone 1
                    if (itemsData.has(clickedItem[0])) {
                        clickedItem.text(itemsData.get(clickedItem[0])); // Restore the original text
                        itemsData.delete(clickedItem[0]); // Remove the entry from the map
                    }
                    sortItems(); // Sort items after removing and returning to Drop Zone 1
                }
            });
            $('#removeModal').modal('hide');
        });

        // Search filter functionality
        $('#searchBox').on('keyup', function () {
            const value = $(this).val().toLowerCase();
            $('#scrollable-zone .item').filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
            });
        });
    });
</script>
    
</body>

</html>